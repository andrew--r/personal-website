---
layout: article
tags: notes
title: Мониторинг падений браузера
description: Используем Reporting API для отслеживания падений бразуера, нарушений политик безопасности и других проблем
date: 2025-02-20
---

В рабочем чате недавно интересовались, можно ли как-то отследить падение браузерной вкладки с нашим веб-приложением. Я о таких способах не знал, поэтому из любопытства отправился гуглить.

Нетривиальность задачи заключается в том, что падение неожиданно обрывает выполнение кода вашего приложения, так что стандартные подходы вроде обработки какого-то глобального события неприменимы, ведь для обработки события нужен живой процесс, исполняющий ваш код.

Как выяснилось, существует экспериментальный [Reporting API](https://w3c.github.io/reporting), позволяющий отслеживать как падения, так и другие виды проблем, например, нарушения политик безопасности (вроде Content Security Policy) и использование устаревших фич.

Reporting API предоставляет два основных способа получения отчётов о проблемах:

1. Глобальный класс `ReportingObserver`, позволяющий подписаться на предупреждения и как-либо их обрабатывать через JavaScript; так как это клиентский API, он не отслеживает падения.
2. HTTP-заголовок `Reporting-Endpoints`, задающий серверные эндпойнты, на которые бразуер должен отправлять собранные отчёты; этот способ покрывает все виды отчётов, включая падения.

На портале Chrome for Developers есть [хороший обзор Reporting API](https://developer.chrome.com/docs/capabilities/web-apis/reporting-api).

Обратите внимание, что API всё ещё не стабилен, спецификация находится в статусе черновика, и пока она реализована не во всех основных браузерах. Несмотря на все эти оговорки, аналогов Reporting API нет, и его уже используют, например, [в Figma](https://neugierig.org/software/blog/2023/01/browser-crashes.html).
